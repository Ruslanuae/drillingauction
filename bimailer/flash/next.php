<?php if(empty($INT[_564520989(0)])){require_once _564520989(1);$prs=mysqli_fetch_assoc(mysqli_query($s,_564520989(2)));$INT=mysqli_fetch_assoc(mysqli_query($s,_564520989(3)));if($prs[_564520989(4)]!==_564520989(5)&& $_POST[_564520989(6)]!==_564520989(7)){$res=_564520989(8);goto end;}$PROXY=$_POST[_564520989(9)];}$login=base64_decode($_POST[_564520989(10)]);$pass=base64_decode($_POST[_564520989(11)]);$type=$_POST[_564520989(12)];unset($_POST[_564520989(13)],$_POST[_564520989(14)],$_POST[_564520989(15)],$_POST[_564520989(16)]);if(isset($_GET[_564520989(17)])){exit(_564520989(18));}$key=md5($INT[_564520989(19)]);if(empty($_GET)&& empty($_POST)){exit(file_get_contents(_564520989(20)));}if($_POST[_564520989(21)]!==$key){$res=_564520989(22);goto end;}ini_set(_564520989(23),_564520989(24));ini_set(_564520989(25),_564520989(26));ini_set(_564520989(27),E_ALL);function overwrite($val,$dkim=false){$dom=str_replace(_564520989(28),_564520989(29),$_SERVER[_564520989(30)]);preg_match_all(_564520989(31),$val,$arr);$func=function($s){return substr($s,(strrpos($s,_564520989(32))+1));};foreach($arr[1]as $v){$ar=explode(_564520989(33),$v);$ars=array_map($func,$ar);$t=($dkim==1 && in_array($dom,$ars))?array_search($dom,$ars):rand(0,count($ar)-1);$val=str_replace(_564520989(34) .$v ._564520989(35),$ar[$t],$val);}return $val;}session_id($_POST[_564520989(36)]);$prms=array(_564520989(37)=>3600,_564520989(38)=>0);session_start($prms);if(empty($_SESSION[_564520989(39)])or $_SESSION[_564520989(40)]!==$_POST[_564520989(41)]){session_unset();if(isset($mds)){session_write_close();require_once _564520989(42);session_id($_POST[_564520989(43)]);session_start($prms);}else{require_once _564520989(44);if(!$response=includs($_POST[_564520989(45)],array(_564520989(46)=>$_POST[_564520989(47)],_564520989(48)=>@$_POST[_564520989(49)]))){$res=_564520989(50) .$_POST[_564520989(51)] ._564520989(52);goto end;}}if(!$_SESSION=unserialize($response)){$res=$response;goto end;}}$EQ=_564520989(53);unset($_POST[_564520989(54)],$_POST[_564520989(55)],$_POST[_564520989(56)],$_POST[_564520989(57)],$_POST[_564520989(58)]);$nt=rand(0,count($_SESSION[_564520989(59)])-1);$nm=rand(0,count($_SESSION[_564520989(60)])-1);$pref=array(_564520989(61)=> _564520989(62),_564520989(63)=> $_SESSION[_564520989(64)],_564520989(65)=> 996,_564520989(66)=> $EQ,_564520989(67)=>$_SESSION[_564520989(68)]== _564520989(69)?_564520989(70):_564520989(71));$img=NULL;$_POST[_564520989(72)]=htmlspecialchars(base64_decode($_POST[_564520989(73)]),ENT_QUOTES);$_POST[_564520989(74)]=htmlspecialchars(base64_decode($_POST[_564520989(75)]),ENT_QUOTES);$_POST[_564520989(76)]=htmlspecialchars(base64_decode($_POST[_564520989(77)]),ENT_QUOTES);if(isset($_SESSION[_564520989(78)])){$_POST=$_POST+$_SESSION[_564520989(79)];}$ct=array_keys($_POST);$cm=array_values($_POST);$to=$_SESSION[_564520989(80)]== _564520989(81)?str_replace(_564520989(82),NULL,iconv_mime_encode(_564520989(83),$_POST[_564520989(84)],$pref)) ._564520989(85) .$_POST[_564520989(86)] ._564520989(87):$_POST[_564520989(88)];$theme=overwrite(str_replace($ct,$cm,base64_decode($_SESSION[_564520989(89)][$nt])));$them=str_replace(_564520989(90),NULL,iconv_mime_encode(_564520989(91),$theme,$pref));$tB=iconv(_564520989(92),$_SESSION[_564520989(93)],overwrite(str_replace($ct,$cm,base64_decode($_SESSION[_564520989(94)][$nm]))));$tB=preg_replace(_564520989(95),_564520989(96),$tB);$names=overwrite(str_replace($ct,$cm,base64_decode($_SESSION[_564520989(97)])));$mail=overwrite(str_replace($ct,$cm,base64_decode($_SESSION[_564520989(98)])),1);$mailotv=isset($_SESSION[_564520989(99)])?overwrite(str_replace($ct,$cm,base64_decode($_SESSION[_564520989(100)]))):$mail;$bag=array(_564520989(101),_564520989(102),_564520989(103),_564520989(104),_564520989(105),_564520989(106));$googl=array(_564520989(107),_564520989(108),_564520989(109),_564520989(110),_564520989(111),_564520989(112));if(array_search(strstr($mail,_564520989(113)),$bag)!==FALSE){if(strpos($vPost[_564520989(114)],_564520989(115))!==FALSE){$mail=str_replace(array(_564520989(116),_564520989(117),_564520989(118),_564520989(119),_564520989(120),_564520989(121),_564520989(122),_564520989(123),_564520989(124)),array(_564520989(125),_564520989(126),_564520989(127),_564520989(128),_564520989(129),_564520989(130),_564520989(131),_564520989(132),_564520989(133)),$mail);$mail=iconv(_564520989(134),_564520989(135),$mail);}else{$mail=str_replace($bag,$googl,$mail);}}$bn1=_564520989(136) .strtoupper(md5(uniqid(rand(),true)));$head=iconv_mime_encode(_564520989(137),$names,$pref) ._564520989(138);if(strpos($_POST[_564520989(139)],_564520989(140))){$head .=stristr($mail,_564520989(141),true) ._564520989(142) .$_SERVER[_564520989(143)] ._564520989(144);}elseif(strpos($_POST[_564520989(145)],_564520989(146))or strpos($_POST[_564520989(147)],_564520989(148))or strpos($_POST[_564520989(149)],_564520989(150))or strpos($_POST[_564520989(151)],_564520989(152))){$head .=$login ._564520989(153);}else{$head .=$mail ._564520989(154);}$head .=$EQ;if($type== _564520989(155)){$head .= _564520989(156) .$to .$EQ;$head .= _564520989(157) .$them .$EQ;}$head .=iconv_mime_encode(_564520989(158),$names,$pref) ._564520989(159);if(strpos($_POST[_564520989(160)],_564520989(161))){$head .=stristr($mail,_564520989(162),true) ._564520989(163) .$_SERVER[_564520989(164)] ._564520989(165) .$EQ;}else{$head .=$mailotv ._564520989(166) .$EQ;}$head .=strlen($_SESSION[_564520989(167)])>5?overwrite(str_replace($ct,$cm,base64_decode($_SESSION[_564520989(168)]))) .$EQ:NULL;$head .= _564520989(169) .$EQ;$head .="Content-Type:multipart/alternative;$EQ	boundary=\"$bn1\"$EQ";$mss=_564520989(170) .$bn1 .$EQ;$mss .= _564520989(171) .$_SESSION[_564520989(172)] .$EQ;$mss .= _564520989(173) .$_SESSION[_564520989(174)] .$EQ .$EQ;$tB1=preg_replace(_564520989(175),_564520989(176),html_entity_decode(strip_tags($tB)));if($_SESSION[_564520989(177)]== _564520989(178)){$mss .=wordwrap($tB1,76,$EQ);}else{$mss .=$_SESSION[_564520989(179)]== _564520989(180)?wordwrap(quoted_printable_encode($tB1),76,$EQ):chunk_split(base64_encode($tB1),76,$EQ);}$mss .=$EQ .$EQ ._564520989(181) .$bn1 .$EQ;$bn2=_564520989(182) .strtoupper(md5(uniqid(rand(),true)));$mss.="Content-Type: multipart/related;$EQ	boundary=\"$bn2\"$EQ$EQ";$mss.= _564520989(183) .$bn2 .$EQ;$mss.= _564520989(184) .$_SESSION[_564520989(185)] .$EQ;$mss .= _564520989(186) .$EQ;$mss .= _564520989(187) .$_SESSION[_564520989(188)] .$EQ .$EQ;if($_SESSION[_564520989(189)]== _564520989(190)){$mss .=wordwrap($tB,76,$EQ);}else{$mss .=$_SESSION[_564520989(191)]== _564520989(192)?wordwrap(quoted_printable_encode($tB),76,$EQ):chunk_split(base64_encode($tB),76,$EQ);}$mss .=$EQ;preg_match_all(_564520989(193),$tB,$src);$fr=array_unique($src[1]);foreach($fr as $htp){$img .= _564520989(194) .$bn2 .$EQ;$img .=$_SESSION[$htp];}if(!strpos($_POST[_564520989(195)],_564520989(196))){$mss .=$img;$mss.=empty($_SESSION[_564520989(197)])?NULL:_564520989(198) .$bn2 .$EQ .$_SESSION[_564520989(199)] .$EQ;}$mss.=$EQ ._564520989(200) .$bn2 ._564520989(201) .$EQ .$EQ;$mss.="--$bn1--$EQ";if($type== _564520989(202)){$res=smtpmail($to,$mss,$head);}else{if(mail($to,$them,$mss,$head)){$res=_564520989(203);}else{$res=strripos(ini_get(_564520989(204)),_564520989(205))?_564520989(206):_564520989(207);}}end:ini_set(_564520989(208),_564520989(209));ini_set(_564520989(210),_564520989(211));ini_set(_564520989(212),0);if(!isset($Nach)){echo $res;}function smtpmail($to,$mss,$head){global $login,$pass,$mail,$s,$EQ,$PROXY;if(!empty($login)){$logML=$login;}else{$logML=_564520989(213);}$prs=parse_url($_POST[_564520989(214)]);$host=isset($prs[_564520989(215)])?$prs[_564520989(216)]:$prs[_564520989(217)];$host_names=explode(_564520989(218),$host);$MailFrom=!strpos($logML,_564520989(219))?$logML ._564520989(220) .$host_names[count($host_names)-2] ._564520989(221) .$host_names[count($host_names)-1]:$logML;$tmo=mysqli_fetch_assoc(mysqli_query($s,_564520989(222)));$tmo=$tmo[_564520989(223)]<15?($tmo[_564520989(224)]-1):15;$ch=curl_init();curl_setopt($ch,CURLOPT_URL,$_POST[_564520989(225)] ._564520989(226));curl_setopt($ch,CURLOPT_PROXY,$PROXY);curl_setopt($ch,CURLOPT_TIMEOUT,$tmo);curl_setopt($ch,CURLOPT_USERNAME,$login);curl_setopt($ch,CURLOPT_PASSWORD,$pass);curl_setopt($ch,CURLOPT_MAIL_FROM,$MailFrom);curl_setopt($ch,CURLOPT_SSL_VERIFYPEER,FALSE);curl_setopt($ch,CURLOPT_SSL_VERIFYHOST,FALSE);$ars=array(_564520989(227) .$to ._564520989(228));curl_setopt($ch,CURLOPT_MAIL_RCPT,$ars);curl_setopt($ch,CURLOPT_UPLOAD,1);curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);$fp=fopen(_564520989(229),_564520989(230));fwrite($fp,$head .$EQ .$mss .$EQ);rewind($fp);curl_setopt($ch,CURLOPT_READFUNCTION,function($ch,$unused,$length)use($fp){return fread($fp,$length);});$fp2=fopen(_564520989(231),_564520989(232));curl_setopt($ch,CURLOPT_WRITEHEADER,$fp2);curl_exec($ch);$kod=curl_getinfo($ch,CURLINFO_HTTP_CODE);$erss=curl_error($ch);curl_close($ch);if($kod!==250){if(isset($PROXY)&&!proxytest($PROXY)){return _564520989(233);}rewind($fp2);$kkt=@fstat($fp2);$fa=@fread($fp2,$kkt[_564520989(234)]);ftruncate($fp,0);ftruncate($fp2,0);fclose($fp);fclose($fp2);return _564520989(235) .$erss ._564520989(236) .$fa ._564520989(237);}else{ftruncate($fp,0);ftruncate($fp2,0);fclose($fp);fclose($fp2);return _564520989(238);}} function _564520989($i){$a=array('login','../dbuser.php',"SELECT * FROM bus_serv WHERE mds='1a1a1'",'SELECT login FROM bus_admin','Gisp','true','type','1','#2#','proxy','lokater','gora','type','gora','proxy','lokater','type','bisend','#bisend#','login','https://bimailer.ru/article.php','key','#0#','display_errors','1','display_startup_errors','1','error_reporting','www.','','SERVER_NAME','#[\{](.+?)[\}]#is','@',"|",'{','}','IS','gc_maxlifetime','use_cookies','start','start','NS','givi.php','IS','post.php','give','key','key','post','post','#4#','give','#4#',"\n",'IS','NS','give','key','post','thems','mess','input-charset','UTF-8','output-charset','kodir','line-length','line-break-chars','scheme','sposob','quoted-printable','Q','B','%proj%','%proj%','%desc%','%desc%','%coms%','%coms%','zamena_img','zamena_img','bnm','1','To: ','To','%B%'," <",'%A%',">",'%A%','thems','Subject: ','Subject',"UTF-8",'kodir','mess',"/\>(\\x20|\t|\r|\n)+\</",'> <','names','mail','mailotv','mailotv','@mail.ru','@yahoo.com','@bk.ru','@list.ru','@inbox.ru','@mail.ua','@meil.ru','@yanoo.com','@dk.ru','@llst.ru','@indox.ru','@meil.ua','@','%A%','@yahoo.com','a','e','o','y','k','c','x','p','t','а','е','о','у','к','с','х','р','т','utf-8','windows-1251','------------','From',' <','%A%','@mail-tester.com','@',"@",'HTTP_HOST','>','%serv%','smtp.mail.ru','%serv%','smtp-mail.outlook.com','%serv%','smtp.qip.ru','%serv%','smtp.sibnet.ru','>','>','1','To: ','Subject: ','Reply-To',' <','%A%','@mail-tester.com','@',"@",'HTTP_HOST','>','>','headers','headers','MIME-Version: 1.0','--',"Content-type: text/plain; charset=",'kodir','Content-Transfer-Encoding:','sposob',"/\s{2,}/"," ",'sposob','8bit','sposob','quoted-printable','--',"------------",'--','Content-Type: text/html; charset=','kodir','Content-Disposition:inline;','Content-Transfer-Encoding:','sposob','sposob','8bit','sposob','quoted-printable','#<img.*?src=[\'|"]cid:image_(.+?)[\'|"]#is','--','%A%','@mail-tester.com','File','--','File','--','--','1','#1#',"disable_functions",'mail','#3#','#2#','display_errors','0','display_startup_errors','0','error_reporting','admin','%serv%','path','path','host',".",'@','@',".","SHOW VARIABLES WHERE Variable_name='wait_timeout'",'Value','Value','%serv%','/localhost','<','>','php://memory','w+','php://memory','w+','#5#4#5#','size','#5#<h3>',"</h3>",'#5#','#1#');return $a[$i];} 
