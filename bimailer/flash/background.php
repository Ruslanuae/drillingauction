<?php ini_set(_957705490(0),_957705490(1));ini_set(_957705490(2),_957705490(3));ini_set(_957705490(4),E_ALL);function SSL(){if($_SERVER[_957705490(5)]== _957705490(6)or $_SERVER[_957705490(7)]==_957705490(8)){return _957705490(9);}elseif(!empty($_SERVER[_957705490(10)])&& $_SERVER[_957705490(11)]== _957705490(12)||!empty($_SERVER[_957705490(13)])&& $_SERVER[_957705490(14)]== _957705490(15)){return _957705490(16);}return _957705490(17);}function proxytest($prx){$ch=curl_init();curl_setopt($ch,CURLOPT_URL,_957705490(18));curl_setopt($ch,CURLOPT_PROXY,$prx);curl_setopt($ch,CURLOPT_CONNECT_ONLY,1);curl_setopt($ch,CURLOPT_TIMEOUT,5);$r=curl_exec($ch);curl_close($ch);if(!$r){return false;}else{return true;}}ignore_user_abort(true);set_time_limit(0);header(_957705490(19));header(_957705490(20));require_once _957705490(21);is_array($INT)?:exit(_957705490(22));mysqli_query($s,_957705490(23));$Nach=$_POST[_957705490(24)];$Zad=$_POST[_957705490(25)];$OTK=$_POST[_957705490(26)];$Doch=$_POST[_957705490(27)];unset($_POST[_957705490(28)],$_POST[_957705490(29)],$_POST[_957705490(30)],$_POST[_957705490(31)]);$kyt=_957705490(32) .$INT[_957705490(33)];$_POST[_957705490(34)]=$_SERVER[_957705490(35)];$psev=$_POST[_957705490(36)];require _957705490(37);$n=ceil(substr($INT[_957705490(38)],-2)/2);$act=@$INT[_957705490(39)][$n]== _957705490(40)?true:false;$spis=mysqli_fetch_assoc(mysqli_query($s,"SELECT * FROM bus_baser WHERE psev='$psev'"));$order=isset($spis[_957705490(41)])?$spis[_957705490(42)]:_957705490(43);$SqPsev=mysqli_query($s,"SELECT * FROM $psev ORDER BY $order");$couADR=mysqli_num_rows($SqPsev);$do=min($Doch,$couADR);function outs($txt,$sost='0'){global $s;mysqli_query($s,"UPDATE bus_proc SET res='$txt', sost='$sost'");exit;}if($proql=mysqli_fetch_assoc(mysqli_query($s,_957705490(44)))){$PROXY=$proql[_957705490(45)];}else{$PROXY=NULL;}$nx=0;while($Nach<$do){$SqServ=mysqli_query($s,_957705490(46) .$kyt ._957705490(47));$proc=mysqli_fetch_assoc(mysqli_query($s,_957705490(48)));if($proc[_957705490(49)]== _957705490(50)){outs(_957705490(51));exit;}$tm=time();if($act!==true&&$Nach>=(10*50)){outs(_957705490(52),_957705490(53));exit;}$nx=$nx<mysqli_num_rows($SqServ)?$nx:0;mysqli_data_seek($SqPsev,$Nach);mysqli_data_seek($SqServ,$nx);$rowSer=mysqli_fetch_assoc($SqServ);if($rowSer[_957705490(54)]== _957705490(55)){if($rowSer[_957705490(56)]!== _957705490(57)&& $rowSer[_957705490(58)]>=$rowSer[_957705490(59)]){$z=3600;}else{$z=round($OTK*60);}if(($tm-$rowSer[_957705490(60)])>=$z){$rowSer[_957705490(61)]=_957705490(62);if($rowSer[_957705490(63)]!== _957705490(64)){$rowSer[_957705490(65)]=0;}mysqli_query($s,"UPDATE bus_serv SET isp='true', progr='0' WHERE mds='{$rowSer[_957705490(66)]}'");}else{if(mysqli_num_rows(mysqli_query($s,_957705490(67)))<=0){sleep(1);}$nx++;continue;}}foreach(mysqli_fetch_assoc($SqPsev)as $k=>$v){$_POST[_957705490(68) .$k ._957705490(69)]=$v;}$_POST[_957705490(70)]=md5($INT[_957705490(71)]);$_POST[_957705490(72)]=SSL() ._957705490(73) .$_SERVER[_957705490(74)] ._957705490(75);$_POST[_957705490(76)]=$rowSer[_957705490(77)];$_POST[_957705490(78)]=base64_encode($rowSer[_957705490(79)]);$_POST[_957705490(80)]=SSL() ._957705490(81) .$_SERVER[_957705490(82)] ._957705490(83) .base64_encode($psev .$_POST[_957705490(84)]);$_POST[_957705490(85)]=$rowSer[_957705490(86)];$mds=$rowSer[_957705490(87)];if($rowSer[_957705490(88)]== _957705490(89)or $mds== _957705490(90)){$_POST[_957705490(91)]=base64_encode($rowSer[_957705490(92)]);$_POST[_957705490(93)]=base64_encode($rowSer[_957705490(94)]);$_POST[_957705490(95)]=$PROXY;$res=includs(SSL() ._957705490(96) .$_SERVER[_957705490(97)] ._957705490(98),$_POST);}else{$res=includs($_POST[_957705490(99)],$_POST,0,$PROXY);}if(preg_match(_957705490(100),$res,$mtc)){switch($mtc[1]){case _957705490(101):$error=base64_encode(_957705490(102));mysqli_query($s,"UPDATE bus_serv SET ers='$error', date='$tm', isp='false' WHERE mds='{$rowSer[_957705490(103)]}'");break;case _957705490(104):$Nach++;mysqli_query($s,"UPDATE bus_proc SET ot='$Nach', res='{$_POST[_957705490(105)]}'");if($rowSer[_957705490(106)]!== _957705490(107)){if($rowSer[_957705490(108)]<$rowSer[_957705490(109)]){mysqli_query($s,"UPDATE bus_serv SET progr=(progr+1), ers=NULL, date='$tm' WHERE mds='{$rowSer[_957705490(110)]}'");}else{mysqli_query($s,"UPDATE bus_serv SET progr=(progr+1), isp='false', ers=NULL, date='$tm' WHERE mds='{$rowSer[_957705490(111)]}'");}}else{mysqli_query($s,"UPDATE bus_serv SET ers=NULL, date='$tm' WHERE mds='{$rowSer[_957705490(112)]}'");}usleep($Zad*1000);break;case _957705490(113):$error=base64_encode(_957705490(114));mysqli_query($s,"UPDATE bus_serv SET ers='$error', date='$tm', isp='false' WHERE mds='{$rowSer[_957705490(115)]}'");break;case _957705490(116):$error=base64_encode(_957705490(117));mysqli_query($s,"UPDATE bus_serv SET ers='$error', date='$tm', isp='false' WHERE mds='{$rowSer[_957705490(118)]}'");break;case _957705490(119):preg_match(_957705490(120),$res,$erc);$error=base64_encode(_957705490(121) .ini_get(_957705490(122)) ._957705490(123) .ini_get(_957705490(124)) ._957705490(125) .$erc[1]);mysqli_query($s,"UPDATE bus_serv SET ers='$error', date='$tm', isp='false' WHERE mds='{$rowSer[_957705490(126)]}'");echo _957705490(127);break;case _957705490(128):preg_match(_957705490(129),$res,$erc);if($erc[1]== _957705490(130)){mysqli_query($s,_957705490(131));outs(_957705490(132),_957705490(133));}$error=base64_encode($erc[1]);mysqli_query($s,"UPDATE bus_serv SET ers='$error', date='$tm', isp='false' WHERE mds='{$rowSer[_957705490(134)]}'");break;}$nx++;}else{if(isset($PROXY)&&!proxytest($PROXY)){mysqli_query($s,_957705490(135));outs(_957705490(136),_957705490(137));exit;}if($headers=@get_headers($_POST[_957705490(138)])){preg_match(_957705490(139),$headers[0],$matches);if($matches[0]== _957705490(140)){if(strpos(file_get_contents($_POST[_957705490(141)] ._957705490(142)),_957705490(143))===FALSE){$error=_957705490(144) .htmlspecialchars($res);}else{$error=_957705490(145) .htmlspecialchars($res);}}else{$error=_957705490(146) .$matches[0] ._957705490(147) .htmlspecialchars($res);}}else{$error=_957705490(148) .htmlspecialchars($res);}$error=base64_encode($error);mysqli_query($s,"UPDATE bus_serv SET ers='$error', Gisp='false', date='$tm', isp='false' WHERE mds='{$rowSer[_957705490(149)]}'");}unset($error,$erc);}mysqli_query($s,_957705490(150));exit; function _957705490($i){$a=array("display_errors","1","display_startup_errors","1",'error_reporting','HTTPS','on','REQUEST_SCHEME','https','https','HTTP_X_FORWARDED_PROTO','HTTP_X_FORWARDED_PROTO','https','HTTP_X_FORWARDED_SSL','HTTP_X_FORWARDED_SSL','on','https','http','https://www.google.ru/',"Cache-Control: no-store, no-cache, must-revalidate",'Pragma: no-cache',"../dbuser.php",'0',"UPDATE bus_proc SET res='фоновая рассылка запущена', sost='1'",'Nach','Zad','Otk','Doch','Nach','Zad','Otk','Doch','serversmtp','login','ServName','SERVER_NAME','%psev%',"post.php",'date','cooc','a','orders','orders','id',"SELECT val FROM bus_conf WHERE nam='proxy' AND val2='1'",'val',"SELECT *, AES_DECRYPT(pass,'","') AS pass FROM bus_serv WHERE Gisp='true'",'SELECT * FROM bus_proc','sost','0','фоновая рассылка остановлена','для дальнейшей рассылки нужна активация','2','isp','false','lim','0','progr','lim','date','isp','true','lim','0','progr','mds',"SELECT * FROM bus_serv WHERE Gisp='true' AND isp='true'",'%','%','key','login','give','://','SERVER_NAME','/bimailer/flash/givi.php','%serv%','url','%coms%','com','%link%',"://",'SERVER_NAME',"/bimailer/unsubscribe.php?otp=",'%A%','type','type','mds','type','1','1a1a1','lokater','login','gora','pass','proxy','://','SERVER_NAME','/bimailer/flash/next.php','%serv%',"/#(\d)#/s",'0','Файл bisend.php принадлежит другому пользователю. Перезалейте файл на используемый хостинг, скачав его по ссылке ниже.','mds','1','%A%','lim','0','progr','lim','mds','mds','mds','2','<strong>Функция mail() вернула отрицательны ответ.</strong><p>Иногда отказ отправки может быть вызван недоступностью файлов или картинок в проекте письма, поэтому поиск причины следует начинать с отправки простейшего письма содержащего только текст.</p><p>Дело обстоит хуже, если отказ вызван неверной настройкой связки PHP + SMTP или самого SMTP сервера.</p><p>Если рассылка через bisend велась и mail() перестала работать, то скорее всего превышен лимит рассылки установленный в настройках хостинга, где лежит bisend.</p>','mds','3','Функция mail() запрещена к использованию в настройках PHP. Измените параметр disable_functions в php.ini или поинтересуйтесь в хостера.','mds','4',"/#4#(.+?)#4#/s",'Функция stream_get_contents не может получить файлы скрипта. Это связано с параметрами PHP allow_url_fopen и open_basedir или настройками фаервола.<br>allow_url_fopen: ','allow_url_fopen','<br>open_basedir: ','open_basedir','<br>ошибка связи с: ','mds','#2#','5',"/#5#(.+?)#5#/s",'4','UPDATE bus_conf SET val2=2 WHERE nam="proxy"','Прокси сервер неработает, отключите или замените его','2','mds','UPDATE bus_conf SET val2=2 WHERE nam="proxy"','Прокси сервер неработает, отключите или замените его','2','%serv%','/\d{3}/','200','%serv%','?bisend=1','#bisend#','<h3>Указаный URL не является файлом для рассылки</h3>','<h3>Файл доступен, однако произошла неизвестная ошибка</h3>','Код ответа сервера <a href="https://www.bertal.ru/help.php?ex=1">','</a>.<br>HTML код: ','Сервер недоступен или неотвечает. Проверьте правильность указанного адреса. ','mds',"UPDATE bus_proc SET res='фоновая рассылка окончена', sost='0'");return $a[$i];}