<?php require_once _979983628(0);is_array($INT)?:exit(header(_979983628(1),TRUE,301));$psev=substr($_POST[_979983628(2)],0,6);$sd=$_POST[_979983628(3)];if($conf=mysqli_query($s,_979983628(4))){$tops=mysqli_fetch_assoc($conf);$bz_otp=$tops[_979983628(5)];}if(mysqli_query($s,"SELECT * FROM $bz_otp")){$p=1;}else{$p=0;}function trm(&$v){$v=trim(trim($v,_979983628(6)));}ini_set(_979983628(7),0);session_id(_979983628(8));session_name(_979983628(9));function refVal($arr){if(strnatcmp(phpversion(),_979983628(10))>= 0){$refs=array();foreach($arr as $key => $value){$refs[$key]=&$arr[$key];}return $refs;}return $arr;}$pat=pathinfo($_POST[_979983628(11)]);switch($pat[_979983628(12)]){case _979983628(13):require_once _979983628(14);$xlsx=SimpleXLSX::parse($sd);foreach($xlsx->sheetNames()as $key => $list){$larr=$xlsx->rows($key);$pols=mysqli_num_fields(mysqli_query($s,_979983628(15) .$psev))-1;$pods=_979983628(16) .implode(array_fill(0,$pols,_979983628(17)));$cont=mysqli_prepare($s,_979983628(18) .$psev ._979983628(19) .$pods ._979983628(20));$g=0;foreach($larr as $value){$i=0;$rows=array_fill(0,$pols,NULL);foreach($value as $c){$c=trim($c);if($i<$pols &&!empty($c)){$rows[$i]=$c;$i++;}else{$i++;continue;}}$g++;$rows[0]=filter_var($rows[0],FILTER_SANITIZE_EMAIL);if($p==1){$to=mysqli_num_rows(mysqli_query($s,"SELECT * FROM $bz_otp WHERE A='{$rows[0]}'"));}if(filter_var($rows[0],FILTER_VALIDATE_EMAIL)==FALSE || $to>0){continue;}array_unshift($rows,$cont,str_pad(_979983628(21),($pols+1),_979983628(22)),NULL);call_user_func_array(_979983628(23),refVal($rows));mysqli_stmt_execute($cont);session_start();$_SESSION[$psev]=round(($g/count($larr))*100,1);session_write_close();}}mysqli_stmt_close($cont);break;case _979983628(24):$larr=file($sd,FILE_IGNORE_NEW_LINES|FILE_SKIP_EMPTY_LINES);$i=0;$cou=count($larr);foreach($larr as $value){$v1=iconv(_979983628(25),_979983628(26),$value);$v=filter_var($v1,FILTER_SANITIZE_EMAIL);$n=_979983628(27) .$psev ." SET A='$v'";if($p==1){$to=mysqli_num_rows(mysqli_query($s,"SELECT * FROM $bz_otp WHERE A='$v'"));}if(filter_var($v,FILTER_VALIDATE_EMAIL)==TRUE && $to<1){mysqli_query($s,$n);}session_start();$_SESSION[$psev]=round(($i/$cou)*100,1);session_write_close();$i++;}break;case _979983628(28):$larr=file($sd,FILE_IGNORE_NEW_LINES|FILE_SKIP_EMPTY_LINES);$separator=array(_979983628(29),_979983628(30),_979983628(31),_979983628(32));$cousep[0]=substr_count($larr[0],_979983628(33));$cousep[1]=substr_count($larr[0],_979983628(34));$cousep[2]=substr_count($larr[0],_979983628(35));$cousep[3]=substr_count($larr[0],_979983628(36));$mxa=array_keys($cousep,max($cousep));$separator=$separator[$mxa[0]];$pols=mysqli_num_fields(mysqli_query($s,_979983628(37) .$psev))-1;$pods=_979983628(38) .implode(array_fill(0,$pols,_979983628(39)));$cont=mysqli_prepare($s,_979983628(40) .$psev ._979983628(41) .$pods ._979983628(42));$g=0;foreach($larr as $value){$i=0;$rows=array_fill(0,$pols,NULL);$value=explode($separator,iconv(_979983628(43),_979983628(44),$value));array_walk($value,_979983628(45));foreach($value as $c){$c=trim($c);if($i<$pols &&!empty($c)){$rows[$i]=$c;$i++;}else{$i++;continue;}}$g++;$rows[0]=filter_var($rows[0],FILTER_SANITIZE_EMAIL);if($p==1){$to=mysqli_num_rows(mysqli_query($s,"SELECT * FROM $bz_otp WHERE A='{$rows[0]}'"));}if(filter_var($rows[0],FILTER_VALIDATE_EMAIL)==FALSE || $to>0){continue;}array_unshift($rows,$cont,str_pad(_979983628(46),($pols+1),_979983628(47)),NULL);call_user_func_array(_979983628(48),refVal($rows));mysqli_stmt_execute($cont);session_start();$_SESSION[$psev]=round(($g/count($larr))*100,1);session_write_close();}mysqli_stmt_close($cont);break;}mysqli_query($s,"ALTER TABLE $psev DROP id");mysqli_query($s,"ALTER TABLE $psev ADD COLUMN id INT (11) NOT NULL AUTO_INCREMENT FIRST, ADD PRIMARY KEY (id)");session_start();unset($_SESSION[$psev]);unlink($sd);$cou=mysqli_fetch_row(mysqli_query($s,_979983628(49) .$psev));echo $cou[0]; function _979983628($i){$a=array("../../dbuser.php",'Location: /bimailer/proj.php','psev','tampname',"SELECT val FROM bus_conf WHERE nam='optis'",'val','"','session.use_cookies','downbase','upload','5.3','fnam','extension','xlsx','simplexlsx.class.php',"SELECT * FROM ",'?',',?','REPLACE INTO ',' VALUES(',')','','s','mysqli_stmt_bind_param','txt','windows-1251','utf-8',"REPLACE INTO ",'csv',';',',','	','|',';',',','	','|',"SELECT * FROM ",'?',',?','REPLACE INTO ',' VALUES(',')','windows-1251','utf-8','trm','','s','mysqli_stmt_bind_param',"SELECT COUNT(A) FROM ");return $a[$i];} ?>